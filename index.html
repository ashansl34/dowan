<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Video Downloader</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for loader */
        .loader {
            border-top-color: #3498db;
            -webkit-animation: spin 1s linear infinite;
            animation: spin 1s linear infinite;
        }
        @-webkit-keyframes spin {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 flex items-center justify-center min-h-screen">

    <div class="container mx-auto p-4 max-w-2xl">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 sm:p-8">
            
            <!-- Header -->
            <div class="text-center mb-8">
                <h1 class="text-3xl sm:text-4xl font-bold text-gray-800 dark:text-white">Video Downloader</h1>
                <p class="text-gray-500 dark:text-gray-400 mt-2">Paste a link from YouTube or Facebook to download.</p>
            </div>

            <!-- Input Form -->
            <div class="space-y-4">
                <div class="relative">
                    <svg class="absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.72"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.72-1.72"></path></svg>
                    <input type="text" id="videoUrl" placeholder="Paste video URL here..." class="w-full pl-12 pr-4 py-3 bg-gray-100 dark:bg-gray-700 border-2 border-transparent focus:border-blue-500 focus:ring-0 rounded-xl transition duration-300">
                </div>
                <button id="downloadBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-xl flex items-center justify-center transition duration-300 disabled:bg-blue-400 disabled:cursor-not-allowed">
                    <svg class="h-6 w-6 mr-2" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                    <span>Download</span>
                </button>
            </div>

            <!-- Results Section -->
            <div id="result" class="mt-8">
                <!-- Loader will be inserted here -->
            </div>
            
            <!-- Message/Error Box -->
            <div id="messageBox" class="mt-6 hidden p-4 rounded-lg text-center"></div>

            <!-- Disclaimer -->
            <div class="mt-8 text-center text-xs text-gray-400 dark:text-gray-500">
                <p>This tool is for personal use only. Please respect the copyright and terms of service of the websites you are downloading from.</p>
            </div>
        </div>
    </div>

    <script>
        const downloadBtn = document.getElementById('downloadBtn');
        const videoUrlInput = document.getElementById('videoUrl');
        const resultDiv = document.getElementById('result');
        const messageBox = document.getElementById('messageBox');

        downloadBtn.addEventListener('click', handleDownload);

        async function handleDownload() {
            const videoUrl = videoUrlInput.value.trim();
            if (!videoUrl) {
                showMessage('Please paste a video URL first.', 'error');
                return;
            }

            // A common pattern for public APIs is to require a POST request.
            // I'm using cobalt.tools as an example, as it has a public, well-documented API.
            // A CORS proxy is used to prevent cross-origin errors in the browser.
            const apiUrl = 'https://corsproxy.io/?https://co.wuk.sh/api/json';

            setLoading(true);
            clearResults();

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        url: videoUrl,
                        vQuality: '1080', // Request a specific quality
                        isNoTTWatermark: true // Example of an API-specific option
                    })
                });

                if (!response.ok) {
                    throw new Error(`API error: ${response.statusText}`);
                }

                const data = await response.json();

                if (data.status === 'error') {
                    throw new Error(data.text || 'The API returned an error.');
                }
                
                if (data.status === 'redirect' || data.status === 'stream') {
                     // If the API returns a direct link, display it
                    displayDownloadLink(data.url);
                } else if (data.status === 'picker') {
                    // If the API returns multiple choices (picker)
                    displayPicker(data.picker);
                }
                
                else {
                    throw new Error('Could not find a downloadable video link.');
                }

            } catch (error) {
                console.error('Download Error:', error);
                showMessage(`An error occurred: ${error.message}`, 'error');
            } finally {
                setLoading(false);
            }
        }

        function displayDownloadLink(url, text = 'Download Video') {
             resultDiv.innerHTML = `
                <a href="${url}" target="_blank" rel="noopener noreferrer" class="block w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-xl flex items-center justify-center transition duration-300">
                    <svg class="h-6 w-6 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                    <span>${text}</span>
                </a>
            `;
        }
        
        function displayPicker(pickerItems) {
            let itemsHtml = '<h3 class="text-center text-lg font-semibold mb-4">Multiple formats found. Choose one:</h3>';
            itemsHtml += '<div class="space-y-3">';
            pickerItems.forEach(item => {
                // If an item has a URL, create a download button for it.
                if (item.url) {
                    const label = item.type === 'video' ? `Video (${item.quality || 'SD'})` : `Audio (${item.type})`;
                     itemsHtml += `
                        <a href="${item.url}" target="_blank" rel="noopener noreferrer" class="block w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg flex items-center justify-between transition duration-300">
                            <span>${item.label || label}</span>
                            <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M10 3a1 1 0 011 1v5.586l2.293-2.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 9.586V4a1 1 0 011-1z"></path><path d="M3 12a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"></path></svg>
                        </a>
                    `;
                }
            });
            itemsHtml += '</div>';
            resultDiv.innerHTML = itemsHtml;
        }


        function setLoading(isLoading) {
            downloadBtn.disabled = isLoading;
            if (isLoading) {
                resultDiv.innerHTML = `
                    <div class="flex justify-center items-center flex-col">
                        <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 mb-4"></div>
                        <p class="text-gray-500 dark:text-gray-400">Fetching video, please wait...</p>
                    </div>
                `;
            } else {
                 if (resultDiv.querySelector('.loader')) {
                    resultDiv.innerHTML = '';
                 }
            }
        }
        
        function showMessage(message, type = 'info') {
            messageBox.textContent = message;
            messageBox.className = 'mt-6 p-4 rounded-lg text-center'; // Reset classes
            if (type === 'error') {
                messageBox.classList.add('bg-red-100', 'dark:bg-red-900', 'text-red-700', 'dark:text-red-200');
            } else {
                messageBox.classList.add('bg-blue-100', 'dark:bg-blue-900', 'text-blue-700', 'dark:text-blue-200');
            }
            messageBox.classList.remove('hidden');
        }

        function clearResults() {
            resultDiv.innerHTML = '';
            messageBox.classList.add('hidden');
        }

    </script>
</body>
</html>
